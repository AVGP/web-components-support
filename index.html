<!doctype html>
<html>
  <head>
    <title>Web component compatibility test</title>
    <style>
      td, th {
        border: thin solid;
      }
    
      td {
        font-weight: bold;
      }
    
      .yay {
        color: green;
      }
      
      .meh {
        color: #883;
      }
      
      .nope {
        color: red;
      }

      .warning {
        background-color: #faa;
        color: #800;
        padding: 1em;
        border: thin solid #800;
        border-radius: 3px;
      }
    </style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37093471-4', 'avgp.github.io');
  ga('send', 'pageview');
</script>    
  </head>
  <body>
  <h1>Web component test</h1>
  <section>
    <article class="warning">
      <h2>Warning!</h2>
      <p>The technologies tested herein are <strong>experimental</strong>.</p>
      <p>The test results may be incorrect, misleading, use this site at your risk!</p>
    </article>

    <article>
    <h2>What is tested</h2>
      <p>Last revision: May 13, 2014</p>
      <p>This page tries to test for support of the following web standard proposals related to web components:</p>
      <ol>
        <li>Template element</li>
        <li>Shadow DOM</li>
        <li>Custom elements</li>
        <li>HTML Imports</li>
      </ol>
    </article>
    
    <article>
      <h2>Contributions, errors and feedback</h2>
      <p>The test's <a href="https://github.com/avgp/web-components-support">source code is hosted on Github</a> and pull requests or issues are highly appreciated, if you spot a problem with the test results.</p>
    </article>
  </section>
  
  <section>
    <article>
      <h2>Test results</h2>
      <table>
        <thead>
          <tr>
            <th>Templates</th>
            <th>Shadow DOM</th>
            <th>Custom Elements</th>
            <th>HTML Imports</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td id="templates">Loading...</td>
            <td id="shadow">   Loading...</td>
            <td id="elements"> Loading...</td>
            <td id="imports">  Loading...</td>
          </tr>
        </tbody>
      </table>
    </article>
  </section>
  
  <template id="t"></template>
  <x-foo></x-foo>
  
  <script>
    //Shadow DOM test
    var shadowResult = document.getElementById("shadow");
    if(document.body.createShadowRoot) {
      shadowResult.textContent = "Supported";
      shadowResult.classList.add("yay");
      keen.addEvent("ShadowDOM", {status: "supported", browser: window.navigator});
    } else if(document.body.webkitCreateShadowRoot) {
      shadowResult.textContent = "Prefixed";
      shadowResult.classList.add("meh");
      keen.addEvent("ShadowDOM", {status: "prefixed", browser: window.navigator});
    } else {
      shadowResult.textContent = "Not supported";
      shadowResult.classList.add("nope");
      keen.addEvent("ShadowDOM", {status: "not supported", browser: window.navigator});
    }
    
    
    //Template test
    var templateResult = document.getElementById("templates");
    if(window.HTMLTemplateElement && document.getElementById("t") instanceof HTMLTemplateElement && document.getElementById("t").content) {
      templateResult.textContent = "Supported";
      templateResult.classList.add("yay");
      ga('send', 'event', 'Support', 'Template', 'Template', 'supported', {'nonInteraction': 1});      
    } else {
      templateResult.textContent = "Not supported";
      templateResult.classList.add("nope");
      ga('send', 'event', 'Support', 'Template', 'Template', 'not supported', {'nonInteraction': 1});      
    }
    
    
    // Custom elements test
    var elemResult = document.getElementById("elements");
    if(document.registerElement) {
      elemResult.textContent = "Partial";
      elemResult.classList.add("meh");
      
      var proto = Object.create(HTMLElement.prototype);
      proto.attachedCallback = function() {
        elemResult.textContent = "Supported";
        elemResult.classList.add("yay");
        elemResult.classList.remove("meh");
        ga('send', 'event', 'Support', 'Custom Element', 'Custom Element', 'supported', {'nonInteraction': 1});      
      };
      
      var XFoo = document.registerElement("x-foo", {prototype: proto});
    } else if(document.webkitRegisterElement) {
      elemResult.textContent = "Partial";
      elemResult.classList.add("meh");
      ga('send', 'event', 'Support', 'Custom Element', 'Custom Element', 'prefixed', {'nonInteraction': 1});      
    } else {
      elemResult.textContent = "Not supported";
      elemResult.classList.add("nope");
      ga('send', 'event', 'Support', 'Custom Element', 'Custom Element', 'not supported', {'nonInteraction': 1});      
    }
    
    
    // HTML Imports
    var importsResult = document.getElementById("imports");
    if('import' in document.createElement('link')) {
      importsResult.textContent = "Support";
      importsResult.classList.add("yay");
      ga('send', 'event', 'Support', 'Imports', 'Imports', 'supported', {'nonInteraction': 1});
    } else {
      importsResult.textContent = "Not supported";
      importsResult.classList.add("nope");
      ga('send', 'event', 'Support', 'Imports', 'Imports', 'not supported', {'nonInteraction': 1});
    }
  </script>
  
  </body>
</html>
